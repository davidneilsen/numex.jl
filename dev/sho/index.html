<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simple Oscillator · numex.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://davidneilsen.github.io/numex.jl/sho/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">numex.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../euler/">Euler&#39;s Method</a></li><li class="is-active"><a class="tocitem" href>Simple Oscillator</a><ul class="internal"><li><a class="tocitem" href="#The-Differential-Equation-and-Solution"><span>The Differential Equation and Solution</span></a></li><li><a class="tocitem" href="#Writing-as-a-First-Order-System"><span>Writing as a First-Order System</span></a></li><li><a class="tocitem" href="#The-Midpoint-Method"><span>The Midpoint Method</span></a></li><li><a class="tocitem" href="#Other-Second-Order-Methods"><span>Other Second-Order Methods</span></a></li><li><a class="tocitem" href="#Convergence"><span>Convergence</span></a></li><li><a class="tocitem" href="#The-DifferentialEquations.jl-Package"><span>The DifferentialEquations.jl Package</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Going-Further"><span>Going Further</span></a></li></ul></li><li><a class="tocitem" href="../vanderpol/">Nonlinear Oscillator</a></li><li><a class="tocitem" href="../binary/">Binary Orbits</a></li><li><a class="tocitem" href="../nbody/">N-Body Gravity</a></li><li><a class="tocitem" href="../cosmo/">Cosmology</a></li><li><a class="tocitem" href="../tov/">Neutron Stars</a></li><li><a class="tocitem" href="../kerr/">Orbits About Black Holes</a></li><li><a class="tocitem" href="../wave1D/">Wave Equation</a></li><li><a class="tocitem" href="../maxwell/">Maxwell</a></li><li><a class="tocitem" href="../fluid/">Fluids</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Simple Oscillator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simple Oscillator</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/davidneilsen/numex.jl/blob/main/docs/src/sho.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-Simple-Harmonic-Oscillator"><a class="docs-heading-anchor" href="#The-Simple-Harmonic-Oscillator">The Simple Harmonic Oscillator</a><a id="The-Simple-Harmonic-Oscillator-1"></a><a class="docs-heading-anchor-permalink" href="#The-Simple-Harmonic-Oscillator" title="Permalink"></a></h1><p>As mentioned before, it is good to test numerical methods with problems with known solutions.  In this example we will use the simple harmonic oscillator.</p><p>We will build on the previous example in two ways.  First, we  solve a system of differential equations, and we will improve on Euler method.</p><h2 id="The-Differential-Equation-and-Solution"><a class="docs-heading-anchor" href="#The-Differential-Equation-and-Solution">The Differential Equation and Solution</a><a id="The-Differential-Equation-and-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#The-Differential-Equation-and-Solution" title="Permalink"></a></h2><p>Let&#39;s now consider the simple harmonic oscillator</p><p class="math-container">\[\frac{d^2 y}{dt^2} = -\omega^2 y.\]</p><p>The equation is solved on a domain <span>$0 \le t$</span> as an initial value problem, with <span>$y(0)$</span> and <span>$\dot{y}(0)$</span> specified at the initial time. The solution of this equation can be written</p><p class="math-container">\[y(t) = A \sin(\omega t) + B\cos(\omega t),\]</p><p>where the constants <code>A</code> and <code>B</code> are chosen to match the initial conditions.  For simplicity, we use the notation that a dot over a variable represents a time derivative</p><p class="math-container">\[\dot y \equiv \frac{dy}{dt}.\]</p><h2 id="Writing-as-a-First-Order-System"><a class="docs-heading-anchor" href="#Writing-as-a-First-Order-System">Writing as a First-Order System</a><a id="Writing-as-a-First-Order-System-1"></a><a class="docs-heading-anchor-permalink" href="#Writing-as-a-First-Order-System" title="Permalink"></a></h2><p>The simple harmonic oscillator equation (SHO) is a second-order equation. Many numerical methods for the initial value problem have been developed for first-order equations.  We can rewrite the SHO as a  system of first-order equations by introducing a new variable <span>$u = \dot y$</span>. Then</p><p class="math-container">\[\begin{aligned}
\dot y &amp;= u\\
\dot u &amp;= -\omega^2 y.
\end{aligned}\]</p><h2 id="The-Midpoint-Method"><a class="docs-heading-anchor" href="#The-Midpoint-Method">The Midpoint Method</a><a id="The-Midpoint-Method-1"></a><a class="docs-heading-anchor-permalink" href="#The-Midpoint-Method" title="Permalink"></a></h2><p>While the Euler method is very simple to use, the method is not very accurate. The Midpoint method is a similar method, but has higher accuracy.   Consider the differential equation</p><p class="math-container">\[\frac{dy}{dt} = f(t,y).\]</p><p>The Euler method approximates the derivative <span>$dy/dt$</span> as a constant <span>$f(t_i)$</span> over the domain <span>$[t_i,t_{i+1}]$</span>, or</p><p class="math-container">\[y_{i+1} = y_i   + \Delta t f(t_i,y_i)\]</p><p>A better approximation might be to use the value of the derivative at the midpoint of <span>$t_i$</span> and <span>$t_{i+1}$</span>, rather than at the endpoint <span>$t_i$</span>, so that</p><p class="math-container">\[y_{i+1} = y_i   + \Delta t f(t_{i+1/2}, y_{i+1/2})\]</p><p>But how do we find the value of <span>$y_{i+1/2}$</span>?  We could use an Euler step of <span>$\Delta t/2$</span>.  Thus, the midpoint method is a two-step method. We first approximate the solution at <span>$t_{i+1/2}$</span> using the Euler method, then we go back to <span>$t_i$</span> and take a full step with the derivative evaluated at <span>$t_{i+1/2}$</span></p><p class="math-container">\[\begin{aligned}
y_{i+1/2} &amp;=  y_i   + \frac{1}{2}\Delta t f(t_i,y_i)\\
y_{i+1} &amp;=  y_i   + \frac{1}{2}\Delta t f(t_{i+1/2},y_{i+1/2}).
\end{aligned}\]</p><h2 id="Other-Second-Order-Methods"><a class="docs-heading-anchor" href="#Other-Second-Order-Methods">Other Second-Order Methods</a><a id="Other-Second-Order-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Second-Order-Methods" title="Permalink"></a></h2><p>The Midpoint method is not the only integrator with second-order accuracy. There is a larger class of Runge-Kutta integrators of different orders, and this is just one of the second-order Runge-Kutta methods, sometimes  called RK2 methods.  A second RK2 method is</p><p class="math-container">\[\begin{aligned}
y^{\star} &amp;=  y_i   + \Delta t f(t_i,y_i)\\
y_{i+1} &amp;=  y_i   + \frac{1}{2}\Delta t 
\left( f(t_i,y_i) + f(t_{i+1},y^{\star})\right).
\end{aligned}\]</p><p>Beginning with the derivative at the left end-point, <span>$f(t_i, y_i)$</span>, the Euler method is used to approximate the derivative at the right end-point, <span>$f(t_{i+1},y^{\star})$</span>.  We see that <span>$y^\star$</span> is a first approximation to <span>$y_{i+1}$</span>, and this step is called the <em>predictor</em> step. The approximation to <span>$y_{i+1}$</span> is refined by stepping from <span>$t_i$</span> to <span>$t_{i+1}$</span> using the average of the two derivatives. This is the <em>corrector</em> step of the algorithm.  </p><h2 id="Convergence"><a class="docs-heading-anchor" href="#Convergence">Convergence</a><a id="Convergence-1"></a><a class="docs-heading-anchor-permalink" href="#Convergence" title="Permalink"></a></h2><p>The Euler method is only first-order accurate, which means that the  error in the discrete solution is proportional to the step-size <span>$\Delta t$</span>. This is often written as <span>${\rm O}(\Delta t)$</span>. If the step size is reduced by a factor of 2, then the error also  drops by factor of 2.  However, the higher-resolution solution requires even more work to compute, as it doubles the number of steps to reach the final time.  </p><p>The Midpoint method is second-order accurate, or <span>${\rm O}(\Delta t^2$</span>. If the step size is reduced by a factor or 2, then the error drops by a factor of <span>$2^2=4$</span>.  As the higher-order solution typically only doubles the amount of work done, this is advantageous because the error  drops faster than the increase in workload.   Even higher order methods could be advantageous by this analysis.  The fourth-order Runge-Kutta method, with <span>${\rm O}(\Delta t^2)$</span>, is widely used for many conventional ODE systems.</p><h2 id="The-DifferentialEquations.jl-Package"><a class="docs-heading-anchor" href="#The-DifferentialEquations.jl-Package">The DifferentialEquations.jl Package</a><a id="The-DifferentialEquations.jl-Package-1"></a><a class="docs-heading-anchor-permalink" href="#The-DifferentialEquations.jl-Package" title="Permalink"></a></h2><p>There are many different numerical algorithms for solving ODEs.  Some are very simple, such as the Euler and RK2 methods seen here.  There are many types of differential equations, however, and many require specialized numerical solvers.  These solvers can also be very complicated. Thus, rather than writing our own solvers for each problem, it is good to find reliable packages of ODE solvers.</p><p>Julia has one of the best packages for solving ordinary differential  equations called <a href="https://diffeq.sciml.ai/stable/">DifferentialEquations.jl</a>. </p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>Consider a driven oscillator with the equations of motion written in first-order form </p><p class="math-container">\[\begin{aligned}
\dot y &amp;= u\\
\dot u &amp;= -100y + 8\cos(9t).
\end{aligned}\]</p><p>This oscillator is driven at a frequency just under the natural frequency <span>$\omega=10$</span>, so the solution will have beats.  The exact solution of this system has the form</p><p class="math-container">\[y(t) = A \cos(10 t) + B \sin(10 t) + \frac{8}{19}\cos(9 t).\]</p><p>where the constants <span>$A$</span> and <span>$B$</span> are determined by initial conditions.</p><p>The Jupyter notebook <a href="https://github.com/davidneilsen/numex.jl/blob/main/examples/EulerMethod.ipynb">EulerMethod.ipynb</a> demonstrates the Euler method to solve the ODE</p><h2 id="Going-Further"><a class="docs-heading-anchor" href="#Going-Further">Going Further</a><a id="Going-Further-1"></a><a class="docs-heading-anchor-permalink" href="#Going-Further" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../euler/">« Euler&#39;s Method</a><a class="docs-footer-nextpage" href="../vanderpol/">Nonlinear Oscillator »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 27 September 2022 19:10">Tuesday 27 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Binary Orbits · numex.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://davidneilsen.github.io/numex.jl/binary/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">numex.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../euler/">Euler&#39;s Method</a></li><li><a class="tocitem" href="../sho/">Simple Oscillator</a></li><li><a class="tocitem" href="../vanderpol/">Nonlinear Oscillator</a></li><li class="is-active"><a class="tocitem" href>Binary Orbits</a><ul class="internal"><li><a class="tocitem" href="#Newtonian-Gravity"><span>Newtonian Gravity</span></a></li><li><a class="tocitem" href="#Relativistic-Corrections"><span>Relativistic Corrections</span></a></li><li><a class="tocitem" href="#Numerical-solutions"><span>Numerical solutions</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../nbody/">N-Body Gravity</a></li><li><a class="tocitem" href="../cosmo/">Cosmology</a></li><li><a class="tocitem" href="../tov/">Neutron Stars</a></li><li><a class="tocitem" href="../kerr/">Orbits About Black Holes</a></li><li><a class="tocitem" href="../wave1D/">Wave Equation</a></li><li><a class="tocitem" href="../maxwell/">Maxwell</a></li><li><a class="tocitem" href="../fluid/">Fluids</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Binary Orbits</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Binary Orbits</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/davidneilsen/numex.jl/blob/main/docs/src/binary.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Binary-Orbits"><a class="docs-heading-anchor" href="#Binary-Orbits">Binary Orbits</a><a id="Binary-Orbits-1"></a><a class="docs-heading-anchor-permalink" href="#Binary-Orbits" title="Permalink"></a></h1><p>People have tracked the motion of planets  across the night sky for thousands of years.  Predicting this  planetary motion has been a concern of science since the time of  ancient Greece, and it led eventually to the work of Copernicus, Kepler,  Newton, and Einstein.</p><p>In this project we begin with a simple model using Newtonian gravity. We then consider corrections to this model from general relativity. Similar models are used by LIGO to search for gravitational waves.</p><h2 id="Newtonian-Gravity"><a class="docs-heading-anchor" href="#Newtonian-Gravity">Newtonian Gravity</a><a id="Newtonian-Gravity-1"></a><a class="docs-heading-anchor-permalink" href="#Newtonian-Gravity" title="Permalink"></a></h2><p>Newton&#39;s universal law of gravitation gives the force between two bodies with mass <span>$m_1$</span> and <span>$m_2$</span> has a magnitude</p><p class="math-container">\[F = \frac{G m_1 m_2}{r^2},\]</p><p>where <span>$G$</span> is Newton&#39;s Gravitation constant, and <span>$r$</span> is the distance between the two masses.</p><h3 id="Approximate-solution-with-Newton&#39;s-Second-Law"><a class="docs-heading-anchor" href="#Approximate-solution-with-Newton&#39;s-Second-Law">Approximate solution with Newton&#39;s Second Law</a><a id="Approximate-solution-with-Newton&#39;s-Second-Law-1"></a><a class="docs-heading-anchor-permalink" href="#Approximate-solution-with-Newton&#39;s-Second-Law" title="Permalink"></a></h3><p>The mass of the our sun dominates the mass of all the other planets in our solar system.  To a good approximation planetary orbits can be found by simply considering the motion of a single planet around a fixed point at the center of the sun.  This approximation works well when the planet&#39;s mass, <span>$m$</span>, is much less than the mass of the sun, <span>$M_\odot,$</span> so that the motion of the sun can  be ignored.</p><p>We first choose a coordinate system.  The sun is fixed at the origin, and the planet&#39;s position is <span>$\mathbf{r}(t)$</span>. The orbit is confined to a plane, so we could use Cartesian coordinates,  <span>$(x,y)$</span>, but polar coordinates</p><p class="math-container">\[r = \sqrt{x^2+ y^2}, \qquad \tan\theta = \frac{y}{x}.\]</p><p>are a natural choice as the gravitational potential is a function of <span>$r$</span>. The calculation of vector derivatives such as the velocity, however, are easiest to perform in Cartesian coordinates</p><p class="math-container">\[x = r\cos\theta, \qquad y = r\sin\theta.\]</p><p>Finally, as a short-hand notation, we use a dot to represent a time derivative</p><p class="math-container">\[\dot{x} \equiv \frac{dx}{dt}.\]</p><p>To solve for the planet&#39;s motion, we could use Newton&#39;s second law directly. However, conserved quantities often simplify the analysis, so let&#39;s see if we can use them.  The total energy in vector form is</p><p class="math-container">\[E = \frac{1}{2} m \dot{\mathbf{r}}^2 - \frac{GMm}{r}.\]</p><p>The kinetic energy is a function of the velocity squared</p><p class="math-container">\[\dot{\mathbf{r}}^2 = \dot{x}^2 + \dot{y}^2.\]</p><p>We write this equation in terms of polar coordinates, and using some trig identities, we get</p><p class="math-container">\[\dot{\mathbf{r}}^2 = \dot{r}^2 + r^2\dot{\theta}^2.\]</p><p>Then the energy can written in polar coordinates as</p><p class="math-container">\[E = \frac{1}{2} m \left(\dot{r}^2 + r^2\dot{\theta}^2\right) - \frac{GMm}{r}.\]</p><p>Energy is not the only conserved quantity in gravitational interactions. The angular momentum is also conserved. The angular momentum is</p><p class="math-container">\[\mathbf{J} = \mathbf{r} \times \mathbf{p}.\]</p><p>The planet is confined to the plane with angular velocity <span>$r\dot{\theta},$</span> so the angular momentum only has a component normal to the plane.</p><p class="math-container">\[J = r \cdot(mr\dot{\theta}) = mr^2\dot{\theta}.\]</p><p>We can use the angular momentum to eliminate <span>$\dot{\theta}$</span> from the energy equation as <span>$\dot{\theta} = \frac{J_z}{mr^2},$</span> giving </p><p class="math-container">\[E = \frac{1}{2} m \left(\dot{r}^2 + r^2 \dot{\theta}^2 \right) - \frac{GMm}{r},\]</p><p>The second and third terms on the RHS depend now only on position, and not on velocity.  We combine these two terms into the effective potential</p><p class="math-container">\[V_{\rm eff} = \frac{J_z^2}{2m r^2} - \frac{GMm}{r},\]</p><p>giving </p><p class="math-container">\[E = \frac{1}{2} m \dot{r}^2 + V_{\rm eff}(r).\]</p><p>Notice that <span>$\theta$</span> terms have now been eliminated from this equation for the energy, making this now effectively a one-dimensional problem.</p><p>To find the equations of motion, we can differentiate the energy equation with respect to time</p><p class="math-container">\[\frac{dE}{dt} = m \dot{r} \ddot{r} + \frac{dV_{\rm eff}(r)}{dr}\dot{r} = 0.\]</p><p>In writing this equation, we have used the chain rule.  For example,</p><p class="math-container">\[\frac{dV}{dt} = \frac{dV}{dr}\frac{dr}{dt} = \frac{dV}{dr}\dot{r}.\]</p><p>The derivative of the energy equation gives the equations of motion, equivalent to Newton&#39;s second law</p><p class="math-container">\[m\ddot{r} = -\frac{dV_{\rm eff}(r)}{dr}.\]</p><p>We write these equations in first-order form, using the radial momentum <span>$p_r = m\dot{r}$</span> and the angular momentum <span>$J = mr^2\dot{\theta}$</span></p><p class="math-container">\[\begin{aligned}
\dot{r} &amp;= \frac{p_r}{m}\\
\dot{\theta} &amp;= \frac{J_z}{mr^2}\\
\dot{p}_r &amp;= \frac{J_z^2}{m r^3} - \frac{GMm}{r^2}\\
\dot{J} &amp;= 0.
\end{aligned}\]</p><p>These equations hold in the approximation that the first body does not move, and that <span>$m_1\gg m_2$</span>.</p><h3 id="Lagrangian"><a class="docs-heading-anchor" href="#Lagrangian">Lagrangian</a><a id="Lagrangian-1"></a><a class="docs-heading-anchor-permalink" href="#Lagrangian" title="Permalink"></a></h3><p>A more careful analysis of the binary problem for arbirary masses is easily done with the Lagrangian formulation of mechanics.  The derivation can be found in books on classical dynamics.  The Lagrangian is found to be</p><p class="math-container">\[L = \frac{1}{2}\mu\dot{r}^2 + \frac{J_z}{2\mu r^2} + \frac{Gm_1 m_2}{r}.\]</p><p>where <span>$\mu$</span> is the reduced mass</p><p class="math-container">\[\mu = \frac{m_1 m_2}{m_1 + m_2}\]</p><p>and <span>$J$</span> is the conserved <span>$z$</span>-component of the angular momentum</p><p class="math-container">\[J = \mu r^2 \dot{\phi}.\]</p><h2 id="Relativistic-Corrections"><a class="docs-heading-anchor" href="#Relativistic-Corrections">Relativistic Corrections</a><a id="Relativistic-Corrections-1"></a><a class="docs-heading-anchor-permalink" href="#Relativistic-Corrections" title="Permalink"></a></h2><h3 id="The-Post-Newtonian-Approximation"><a class="docs-heading-anchor" href="#The-Post-Newtonian-Approximation">The Post-Newtonian Approximation</a><a id="The-Post-Newtonian-Approximation-1"></a><a class="docs-heading-anchor-permalink" href="#The-Post-Newtonian-Approximation" title="Permalink"></a></h3><p>The Hamiltonian for the binary system is often derived using normalized variables.  Working in the center-of-mass frame,  <span>$\mathbf{p}_1 + \mathbf{p}_2 = 0$</span>, we define</p><p class="math-container">\[\mathbf{r} = \frac{\mathbf{x}_1 - \mathbf{x}_2}{GM},\qquad
\mathbf{p} = \frac{\mathbf{p_1}}{\mu} = -\frac{\mathbf{p_2}}{\mu}, \qquad
\hat{t} \equiv \frac{t}{GM}, \qquad
\hat{H} \equiv \frac{H}{\mu},\]</p><p>where</p><p class="math-container">\[M \equiv m_1 + m_2, \qquad \mu \equiv \frac{m_1 m_2}{M}, \qquad \nu \equiv \frac{\mu}{M}.\]</p><p class="math-container">\[\dot{\mathbf{r}} = \frac{d\mathbf{r}}{d\hat{t}} = \frac{d(\mathbf{x}_1 - \mathbf{x}_2)}{dt}, 
\qquad \dot{\mathbf{p}} = \frac{d\mathbf{p}}{d\hat{t}} = \frac{G}{\nu}\frac{d\mathbf{p}_1}{dt}.\]</p><p class="math-container">\[\hat{H}(\mathbf{r},\mathbf{p}) = \hat{H}_{N}(\mathbf{r},\mathbf{p})
    + \frac{1}{c^2}\hat{H}_{1PN}(\mathbf{r},\mathbf{p})
    + \frac{1}{c^4}\hat{H}_{2PN}(\mathbf{r},\mathbf{p}).\]</p><p class="math-container">\[\begin{aligned}
\hat{H}_{N}(\mathbf{r},\mathbf{p}) &amp;= \frac{\mathbf{p}^2}{2} - \frac{1}{r},\\
\hat{H}_{1PN}(\mathbf{r},\mathbf{p}) &amp;= \frac{1}{8}(3\nu -1)\left(\mathbf{p}^2\right)^2
   - \frac{1}{2}\left[ \left(3 + \nu \right)\mathbf{p}^2 
   + \nu(\mathbf{n}\cdot\mathbf{p})^2\right]\frac{1}{r} + \frac{1}{2r^2},\\
\hat{H}_{2PN}(\mathbf{r},\mathbf{p}) &amp;= \frac{1}{16}\left(1 - 5\nu + 5\nu^2\right)\left(\mathbf{p}^2\right)^3 \\
 &amp;\quad   + \frac{1}{8}\left[ \left(5 - 20\nu - 3\nu^2\right) \left(\mathbf{p}^2\right)^2  
         -2\nu^2(\mathbf{n}\cdot\mathbf{p})^2\mathbf{p}^2 
         - 3\nu^2(\mathbf{n}\cdot\mathbf{p})^4\right]\frac{1}{r}\\
&amp;\quad + \frac{1}{2}\left[ \left(5 + 8\nu\right)\mathbf{p}^2  + 3\nu(\mathbf{n}\cdot\mathbf{p})^2 \right]
       \frac{1}{r^2} - \frac{1}{4}(1+3\nu)\frac{1}{r^3}.
\end{aligned}\]</p><p>The additional force term causes the elliptical orbits to precess.  The precession of Mercury&#39;s orbit was first measured in 1859 by Urbain Le Verrier. Most of the precession can be explained by perturbations from other planets, such as Jupiter.  However, these perturbations did not explain  the total observed precession. While developing general relativity, Albert Einstein realized that relativistic effects also cause orbital precession, and general relativity explains the missing part of the Mercury&#39;s precession.  This is one of the three classical tests of general relativity.</p><h2 id="Numerical-solutions"><a class="docs-heading-anchor" href="#Numerical-solutions">Numerical solutions</a><a id="Numerical-solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-solutions" title="Permalink"></a></h2><p>The equations of motion in first order form can be solved using ODE solvers in the <a href="https://diffeq.sciml.ai/stable/">DifferentialEquations.jl</a>  package.  </p><p>The repository has an example Jupyter notebook <a href="https://github.com/davidneilsen/numex.jl/blob/main/examples/PostNewtonianBinaryOrbits.ipynb"><code>PostNewtonianBinaryOrbits.ipynb</code></a> that solves the binary equations in Newtonian and post-Newtonian gravity.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>T. Damour, P. Jaranowski, and G. Schäfer, &quot;Dynamical invariants for general relativistic two-body systems at the third post-Newtonian approximation,&quot; <em>Physical Review</em> <strong>D62</strong> 044024 (2000). <a href="https://journals.aps.org/prd/abstract/10.1103/PhysRevD.62.044024">Journal</a>, or <a href="https://arxiv.org/abs/gr-qc/9912092">arXiv</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../vanderpol/">« Nonlinear Oscillator</a><a class="docs-footer-nextpage" href="../nbody/">N-Body Gravity »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 28 September 2022 15:48">Wednesday 28 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
